"use strict";(self.webpackChunkcurso_angular=self.webpackChunkcurso_angular||[]).push([[339],{6339:(Ct,b,r)=>{r.r(b),r.d(b,{TripsAdministrationModule:()=>gt});var T=r(6814),c=r(6223),s=r(5313),d=r(1896);class y{constructor(n,o,i,a,l,m,g){this.id=n,this.lugarSalida=o,this.lugarDestino=i,this.fechaLlegada=new Date(a),this.fechaSalida=new Date(l),this.idColectivo=m,this.personaId=g}}var t=r(5879),N=r(553),p=r(6306),u=r(8504),M=r(9862);let x=(()=>{class e{constructor(o){this.http=o,this.resourceUrl=N.N.backendUrl+"viajes"}findAll(){return this.http.get(this.resourceUrl,{observe:"response"}).pipe((0,p.K)(o=>(console.log("Ocurrio un error"),(0,u._)(()=>"Paso algo"))))}findOne(o){return this.http.get(this.resourceUrl+"/"+o).pipe((0,p.K)(i=>(console.log("Ocurrio un error: "),console.log(i),(0,u._)(()=>"No existe el Viaje"))))}crearViaje(o){return this.http.post(this.resourceUrl,o).pipe((0,p.K)(i=>(console.log("Ocurrio un error: "),console.log(i),(0,u._)(()=>"No se pudo crear viaje"))))}actualizarViaje(o){return this.http.put(this.resourceUrl+"/"+o.id,o).pipe((0,p.K)(i=>(console.log("Ocurrio un error: "),console.log(i),(0,u._)(()=>"No se pudo actualizar viaje con id"+o.id))))}borrar(o){return this.http.delete(this.resourceUrl+"/"+o,{observe:"response"}).pipe((0,p.K)(i=>(console.log("Ocurrio un error: "),console.log(i),(0,u._)(()=>"No existe el viaje"))))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(M.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=r(8732),S=r(7809),Y=r(1798),C=r(2939),_=r(617),f=r(2296);function q(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," ID "),t.qZA())}function O(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.id," ")}}function I(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Origen "),t.qZA())}function k(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.lugarSalida," ")}}function Q(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Destino "),t.qZA())}function j(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.lugarDestino," ")}}function J(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Partida "),t.qZA())}function w(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.fechaSalida,"dd/MM/YYYY - hh:mm")," ")}}function P(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Arrivo "),t.qZA())}function B(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.fechaLlegada,"dd/MM/YYY - hh:mm")," ")}}function R(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Colectivo "),t.qZA())}function K(e,n){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",null==o.colectivo?null:o.colectivo.patente,"")}}function V(e,n){1&e&&(t.TgZ(0,"th",13),t._uU(1," Acciones "),t.qZA())}function z(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",14)(1,"button",15),t.NdJ("click",function(){const l=t.CHM(o).$implicit,m=t.oxw();return t.KtG(m.seleccionarViaje(l))}),t.TgZ(2,"mat-icon"),t._uU(3,"create"),t.qZA()(),t.TgZ(4,"button",16),t.NdJ("click",function(){const l=t.CHM(o).$implicit,m=t.oxw();return t.KtG(m.borrarViaje(l))}),t.TgZ(5,"mat-icon"),t._uU(6,"delete_sweep"),t.qZA()()()}}function $(e,n){1&e&&t._UZ(0,"tr",17)}function H(e,n){1&e&&t._UZ(0,"tr",18)}let G=(()=>{class e{constructor(o,i,a,l,m,g){this.tripSrv=o,this.busSrv=i,this.personSrv=a,this.router=l,this.modeloSrv=m,this.matSnackBar=g,this.displayedColumns=["id","lugarSalida","lugarDestino","fechaSalida","fechaLlegada","colectivo","acciones"],this.dataSource=[]}ngOnInit(){this.loadTrip()}loadTrip(){this.tripSrv.findAll().subscribe(o=>{this.dataSource=o.body.map(i=>{const a=new y(i.id,i.lugarSalida,i.lugarDestino,i.fechaLlegada,i.fechaSalida,i.idColectivo,i.personaId);return this.loadColectivo(a),a})})}seleccionarViaje(o){this.router.navigate(["trips","detail",o.id])}loadColectivo(o){this.busSrv.findOne(o.idColectivo).subscribe(i=>{o.colectivo=i.body,this.loadModelo(o.colectivo)})}borrarViaje(o){this.tripSrv.borrar(o.id).subscribe(i=>{this.matSnackBar.open("Se borro correctamente el viaje","Cerrar"),this.loadTrip()},i=>{this.matSnackBar.open(i,"Cerrar")})}loadModelo(o){this.modeloSrv.findOne(o.modeloId).subscribe(i=>{o.modelo=i})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(x),t.Y36(A.Z),t.Y36(S.R),t.Y36(d.F0),t.Y36(Y.y),t.Y36(C.ux))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-trip-list"]],decls:27,vars:3,consts:[["routerLink","/trips/create","mat-icon-button","",1,"crearTrip"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","cabecera",4,"matCellDef"],["matColumnDef","lugarSalida"],["matColumnDef","lugarDestino"],["matColumnDef","fechaSalida"],["matColumnDef","fechaLlegada"],["matColumnDef","colectivo"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"cabecera"],["mat-fab","","color","primary",1,"acciones1",3,"click"],["mat-fab","","color","warn",1,"acciones",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,i){1&o&&(t.TgZ(0,"button",0)(1,"mat-icon"),t._uU(2,"add"),t.qZA()(),t.TgZ(3,"table",1),t.ynx(4,2),t.YNc(5,q,2,0,"th",3),t.YNc(6,O,2,1,"td",4),t.BQk(),t.ynx(7,5),t.YNc(8,I,2,0,"th",3),t.YNc(9,k,2,1,"td",4),t.BQk(),t.ynx(10,6),t.YNc(11,Q,2,0,"th",3),t.YNc(12,j,2,1,"td",4),t.BQk(),t.ynx(13,7),t.YNc(14,J,2,0,"th",3),t.YNc(15,w,3,4,"td",4),t.BQk(),t.ynx(16,8),t.YNc(17,P,2,0,"th",3),t.YNc(18,B,3,4,"td",4),t.BQk(),t.ynx(19,9),t.YNc(20,R,2,0,"th",3),t.YNc(21,K,2,1,"td",4),t.BQk(),t.ynx(22,10),t.YNc(23,V,2,0,"th",3),t.YNc(24,z,7,0,"td",4),t.BQk(),t.YNc(25,$,1,0,"tr",11),t.YNc(26,H,1,0,"tr",12),t.qZA()),2&o&&(t.xp6(3),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns))},dependencies:[s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,_.Hw,f.RK,f.cs,d.rH,T.uU],styles:["mat-card[_ngcontent-%COMP%]{margin-bottom:8px}.acciones[_ngcontent-%COMP%]{margin-left:10px}.persona-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:20px;margin:20px}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-mdc-table[_ngcontent-%COMP%]{table-layout:auto;white-space:pre;background-color:#6aa9fc}.mdc-data-table__table[_ngcontent-%COMP%]{min-width:80%;margin:auto;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mat-mdc-table[_ngcontent-%COMP%]   .mdc-data-table__header-row[_ngcontent-%COMP%]{height:56px;background-color:#1774ee}.acciones[_ngcontent-%COMP%]{margin-left:10px;width:35px;height:35px}.acciones1[_ngcontent-%COMP%]{width:35px;height:35px}.crearTrip[_ngcontent-%COMP%]{background-color:#6aa9fc;margin-bottom:20px}.cabecera[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:center}"]}),e})();var X=r(9548),E=r(2894),W=r(8389),D=r(5195),h=r(9157),U=r(2032),v=r(8034),F=r(8525),Z=r(3680);function tt(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requerido "),t.qZA())}function et(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,tt,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.origen.errors.required)}}function ot(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requeridodo "),t.qZA())}function it(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,ot,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.destino.errors.required)}}function nt(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requerido "),t.qZA())}function rt(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,nt,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.fechaSalida.errors.required)}}function at(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requerido "),t.qZA())}function ct(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,at,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.fechaLlegada.errors.required)}}function lt(e,n){if(1&e&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.Q6J("value",o.id),t.xp6(1),t.lnq(" ",o.patente," - ",o.cantidadAsientos," - ",null==o.modelo?null:o.modelo.marca," ")}}function st(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requerido "),t.qZA())}function mt(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,st,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.colectivo.errors.required)}}function dt(e,n){if(1&e&&(t.TgZ(0,"mat-option",21),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.Q6J("value",o.id),t.xp6(1),t.AsE(" ",o.nombre," ",o.apellido," ")}}function pt(e,n){1&e&&(t.TgZ(0,"mat-hint",20),t._uU(1," Campo requerido "),t.qZA())}function ut(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,pt,2,0,"mat-hint",19),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.tripForm.controls.pasajeros.errors.required)}}let L=(()=>{class e{constructor(o,i,a,l,m,g,Tt,vt){this.fb=o,this.busSrv=i,this.matSnackBar=a,this.modelSrv=l,this.router=m,this.route=g,this.personSrv=Tt,this.tripSrv=vt,this.tripForm=this.fb.group({origen:["",c.kI.required],destino:["",c.kI.required],fechaSalida:[new Date,c.kI.required],fechaLlegada:[new Date,c.kI.required],colectivo:[0,c.kI.required],pasajeros:[[0],c.kI.required]}),this.busList=[],this.personList=[],this.selectedTrip=null}ngOnInit(){this.route.paramMap.subscribe(o=>{const i=o.get("id");i&&this.findTrip(Number(i))}),this.loadColectivo(this.selectedTrip),this.busSrv.findAll().subscribe(o=>{this.busList=o.body.map(i=>{const a=new X.G(i.id,i.patente,i.cantidadAsientos,i.modeloId,i.modelo);return this.findModeloColectivo(a),a})},o=>{this.matSnackBar.open(o,"cerrar")}),this.personSrv.findAll().subscribe(o=>{this.personList=o.body.map(i=>new W.F(i.id,i.age,i.name,i.lastName))})}findTrip(o){this.tripSrv.findOne(o).subscribe(i=>{this.selectedTrip=i,this.tripForm.patchValue({origen:i.lugarSalida,destino:i.lugarDestino,fechaSalida:new Date(i.fechaSalida),fechaLlegada:new Date(i.fechaLlegada),colectivo:i.idColectivo,pasajeros:i.personaId})},i=>{this.matSnackBar.open(i,"Cerrar"),this.router.navigate(["trips","list"])})}findModeloColectivo(o){this.modelSrv.findOne(o.modeloId).subscribe(i=>{o.modelo=new E.Z(i.id,i.nombre,i.marca)})}loadColectivo(o){o&&o.colectivo&&this.busSrv.findOne(o.colectivo.id).subscribe(i=>{o.colectivo=i.body})}guardarCambios(){const o=this.tripForm.get("pasajeros").value,i={lugarSalida:this.tripForm.get("origen").value,lugarDestino:this.tripForm.get("destino").value,fechaLlegada:this.tripForm.get("fechaLlegada").value,fechaSalida:this.tripForm.get("fechaSalida").value,personaId:o,idColectivo:this.tripForm.get("colectivo").value};this.selectedTrip&&this.selectedTrip.id?(i.id=this.selectedTrip.id,this.tripSrv.actualizarViaje(i).subscribe(a=>{this.matSnackBar.open("Se guardaron los cambios del viaje","Cerrar"),this.router.navigate(["trips","list"])},a=>{this.matSnackBar.open(a,"Cerrar")})):this.tripSrv.crearViaje(i).subscribe(a=>{this.matSnackBar.open("Se creo el viaje correctamente","Cerrar"),this.router.navigate(["trips","list"])},a=>{this.matSnackBar.open(a,"Cerrar")})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(c.qu),t.Y36(A.Z),t.Y36(C.ux),t.Y36(Y.y),t.Y36(d.F0),t.Y36(d.gz),t.Y36(S.R),t.Y36(x))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-trips-detail"]],decls:55,vars:14,consts:[[1,"viajes",3,"formGroup"],["routerLink","/trips/list","mat-icon-button","",1,"go-back-button"],[1,"bus-container",2,"padding","20px"],[1,"title"],[1,"tripInput"],["matInput","","type","text","formControlName","origen"],[4,"ngIf"],["matInput","","type","text","formControlName","destino"],["matInput","","formControlName","fechaSalida",3,"matDatepicker"],["matIconSuffix","",3,"for"],["pickerSalida",""],["matInput","","formControlName","fechaLlegada",3,"matDatepicker"],["pickerLlegada",""],["formControlName","colectivo"],["disabled",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","colectivo"],["formControlName","pasajeros","multiple",""],["type","submit","mat-button","",3,"disabled","click"],["style","color: red",4,"ngIf"],[2,"color","red"],[3,"value"]],template:function(o,i){if(1&o&&(t.TgZ(0,"form",0)(1,"button",1)(2,"mat-icon"),t._uU(3,"arrow_back"),t.qZA()(),t.TgZ(4,"mat-card",2)(5,"div",3)(6,"h2"),t._uU(7,"Crear / Editar Viaje"),t.qZA()(),t.TgZ(8,"mat-form-field",4)(9,"mat-label"),t._uU(10,"Origen:"),t.qZA(),t._UZ(11,"input",5),t.YNc(12,et,2,1,"div",6),t.qZA(),t.TgZ(13,"mat-form-field",4)(14,"mat-label"),t._uU(15,"Destino:"),t.qZA(),t._UZ(16,"input",7),t.YNc(17,it,2,1,"div",6),t.qZA(),t.TgZ(18,"mat-form-field",4)(19,"mat-label"),t._uU(20,"Fecha de Salida:"),t.qZA(),t._UZ(21,"input",8),t.TgZ(22,"mat-hint"),t._uU(23,"MM/DD/YYYY"),t.qZA(),t._UZ(24,"mat-datepicker-toggle",9)(25,"mat-datepicker",null,10),t.YNc(27,rt,2,1,"div",6),t.qZA(),t.TgZ(28,"mat-form-field",4)(29,"mat-label"),t._uU(30,"Fecha de Llegada:"),t.qZA(),t._UZ(31,"input",11),t.TgZ(32,"mat-hint"),t._uU(33,"MM/DD/YYYY"),t.qZA(),t._UZ(34,"mat-datepicker-toggle",9)(35,"mat-datepicker",null,12),t.YNc(37,ct,2,1,"div",6),t.qZA(),t.TgZ(38,"mat-form-field",4)(39,"mat-label"),t._uU(40,"Colectivo:"),t.qZA(),t.TgZ(41,"mat-select",13)(42,"mat-option",14),t._uU(43," -- "),t.qZA(),t.YNc(44,lt,2,4,"mat-option",15),t.qZA(),t._UZ(45,"input",16),t.YNc(46,mt,2,1,"div",6),t.qZA(),t.TgZ(47,"mat-form-field",4)(48,"mat-label"),t._uU(49,"Pasajeros:"),t.qZA(),t.TgZ(50,"mat-select",17),t.YNc(51,dt,2,3,"mat-option",15),t.qZA(),t.YNc(52,ut,2,1,"div",6),t.qZA(),t.TgZ(53,"button",18),t.NdJ("click",function(){return i.guardarCambios()}),t._uU(54,"Guardar"),t.qZA()()()),2&o){const a=t.MAs(26),l=t.MAs(36);t.Q6J("formGroup",i.tripForm),t.xp6(12),t.Q6J("ngIf",i.tripForm.controls.origen.invalid&&(i.tripForm.controls.origen.dirty||i.tripForm.controls.origen.touched)),t.xp6(5),t.Q6J("ngIf",i.tripForm.controls.destino.invalid&&(i.tripForm.controls.destino.dirty||i.tripForm.controls.destino.touched)),t.xp6(4),t.Q6J("matDatepicker",a),t.xp6(3),t.Q6J("for",a),t.xp6(3),t.Q6J("ngIf",i.tripForm.controls.fechaSalida.invalid&&(i.tripForm.controls.fechaSalida.dirty||i.tripForm.controls.fechaSalida.touched)),t.xp6(4),t.Q6J("matDatepicker",l),t.xp6(3),t.Q6J("for",l),t.xp6(3),t.Q6J("ngIf",i.tripForm.controls.fechaLlegada.invalid&&(i.tripForm.controls.fechaLlegada.dirty||i.tripForm.controls.fechaLlegada.touched)),t.xp6(7),t.Q6J("ngForOf",i.busList),t.xp6(2),t.Q6J("ngIf",i.tripForm.controls.colectivo.invalid&&(i.tripForm.controls.colectivo.dirty||i.tripForm.controls.colectivo.touched)),t.xp6(5),t.Q6J("ngForOf",i.personList),t.xp6(1),t.Q6J("ngIf",i.tripForm.controls.pasajeros.invalid&&(i.tripForm.controls.pasajeros.dirty||i.tripForm.controls.pasajeros.touched)),t.xp6(1),t.Q6J("disabled",i.tripForm.invalid)}},dependencies:[T.sg,T.O5,_.Hw,D.a8,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,h.KE,h.hX,h.bx,h.R9,U.Nt,v.Mq,v.hl,v.nW,F.gD,Z.ey,f.lW,f.RK,d.rH],styles:[".viajes[_ngcontent-%COMP%]{display:flex;flex-direction:column}.bus-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:80%;background:rgb(106,169,252);margin:auto}.tripInput[_ngcontent-%COMP%]{width:50%;align-self:center}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px}.go-back-button[_ngcontent-%COMP%]{bottom:7px;background-color:#6aa9fc}.mat-mdc-button[_ngcontent-%COMP%]:not(:disabled){color:#fff}.mat-mdc-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-raised-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-unelevated-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-outlined-button.mat-mdc-button-base[_ngcontent-%COMP%]{height:36px;width:18%;background-color:#1774ee;margin:auto}"]}),e})();const ft=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:G},{path:"create",component:L},{path:"detail/:id",component:L}];let ht=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.Bz.forChild(ft),d.Bz]}),e})(),gt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[T.ez,s.p0,_.Ps,D.QW,c.UX,h.lN,U.c,C.ZX,v.FA,Z.XK,F.LD,Z.Ng,f.ot,ht]}),e})()}}]);